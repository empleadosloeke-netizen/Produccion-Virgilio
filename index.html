<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reporte Empleados</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 16px;
}

.hidden { display: none; }

button {
  width: 100%;
  padding: 14px;
  font-size: 20px;
  margin-top: 12px;
}

/* ---------- LEGAJO ---------- */
#legajoScreen h1 {
  font-size: 42px;
  text-align: center;
}

#legajoInput {
  width: 100%;
  font-size: 36px;
  padding: 12px;
  text-align: center;
}

/* ---------- TOP ---------- */
.top-bar {
  display: flex;
  align-items: center;
}

.back {
  font-size: 26px;
  cursor: pointer;
}

/* ---------- GRID ---------- */
.grid {
  display: grid;
  grid-template-columns: repeat(6, minmax(0, 1fr));
  gap: 6px;
  margin-top: 16px;
}

.box {
  border: 2px solid #333;
  padding: 6px;
  text-align: center;
  cursor: pointer;
}

.box-title {
  font-size: 20px;
  font-weight: bold;
}

.box-desc {
  font-size: 11px;
  margin-top: 4px;
}

/* ---------- SELECCION ---------- */
.selected-container {
  display: flex;
  align-items: center;
  margin-top: 20px;
}

.selected-box {
  border: 2px solid #333;
  padding: 12px;
  font-size: 26px;
  font-weight: bold;
  cursor: pointer;
}

.description {
  margin-left: 12px;
  font-size: 16px;
}

/* ---------- INPUT ---------- */
.label {
  margin-top: 20px;
  font-size: 18px;
}

.text-input {
  width: 100%;
  height: 55px;
  font-size: 48px;
  text-transform: uppercase;
  text-align: center;
}

.error {
  color: red;
  margin-top: 10px;
  font-size: 18px;
}
</style>
</head>

<body>

<!-- ================= LEGAJO ================= -->
<div id="legajoScreen">
  <h1>Ingres√° tu n√∫mero de legajo</h1>
  <input id="legajoInput" type="number" inputmode="numeric">
  <button onclick="goToOptions()">Continuar</button>
</div>

<!-- ================= OPCIONES ================= -->
<div id="optionsScreen" class="hidden">

  <div class="top-bar">
    <div class="back" onclick="goBack()">‚Üê</div>
  </div>

  <div id="grid" class="grid"></div>

  <div id="selectedArea" class="hidden">
    <div class="selected-container">
      <div id="selectedBox" class="selected-box" onclick="resetSelection()"></div>
      <div id="description" class="description"></div>
    </div>

    <div id="inputLabel" class="label"></div>
    <input id="textInput" class="text-input">
    <button onclick="send()">Enviar</button>
    <div id="error" class="error"></div>
  </div>

</div>

<script>
/* üî¥ PEG√Å AC√Å TU URL DEL APPS SCRIPT */
const GOOGLE_SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbwtBRC-bEeVkFNa8MQnJwJr_L4DalBVoS6N8H9C1Z0vh2CLI29Sep7ZZIIVKz6eOGzj/exec";

/* ---------- OPCIONES ---------- */
const options = [
  { code: "EP", desc: "Empec√© Picking" },
  { code: "TP", desc: "Fin Picking" },
  { code: "AP", desc: "Empec√© Armado Pedido" },
  { code: "TAP", desc: "Termin√© Armado Pedido" },
  { code: "CR", desc: "Control Remitos" },
  { code: "CC", desc: "Inicio/Fin Carga Cami√≥n" },

  { code: "RT", desc: "Recepci√≥n Mercader√≠a" },
  { code: "MG", desc: "Guardado a G√≥ndola" },
  { code: "RI", desc: "Recepci√≥n Insumos" },
  { code: "EI", desc: "Entrega Insumos" },
  { code: "AT", desc: "Atend√≠ Timbre" },
  { code: "PB", desc: "Par√© Ba√±o" },
  { code: "Limp", desc: "Limpieza" },
  { code: "Perm", desc: "Permiso de Salida" },
  { code: "PC", desc: "Par√© Comida" }
];

let selected = null;

/* ---------- GRID ---------- */
const grid = document.getElementById("grid");

options.forEach(opt => {
  const div = document.createElement("div");
  div.className = "box";
  div.innerHTML = `
    <div class="box-title">${opt.code}</div>
    <div class="box-desc">${opt.desc}</div>
  `;
  div.onclick = () => selectOption(opt);
  grid.appendChild(div);
});

/* ---------- NAVEGACION ---------- */
function goToOptions() {
  const legajo = document.getElementById("legajoInput").value;
  if (!legajo) {
    alert("Ingres√° el n√∫mero de legajo");
    return;
  }
  document.getElementById("legajoScreen").classList.add("hidden");
  document.getElementById("optionsScreen").classList.remove("hidden");
}

function goBack() {
  document.getElementById("optionsScreen").classList.add("hidden");
  document.getElementById("legajoScreen").classList.remove("hidden");
}

/* ---------- SELECCION ---------- */
function selectOption(opt) {
  selected = opt;
  grid.classList.add("hidden");
  document.getElementById("selectedArea").classList.remove("hidden");

  document.getElementById("selectedBox").innerText = opt.code;
  document.getElementById("description").innerText = opt.desc;

  const input = document.getElementById("textInput");
  input.value = "";
  document.getElementById("error").innerText = "";

  if (["EP","TP","AP","TAP","CR"].includes(opt.code)) {
    document.getElementById("inputLabel").innerText = "Ingresar N√∫mero Picking";
    input.placeholder = "Ej: A12B";
  } else if (opt.code === "CC") {
    document.getElementById("inputLabel").innerText = "Ingresar C√≥digo (opcional)";
    input.placeholder = "Ej: A12";
  } else {
    document.getElementById("inputLabel").innerText = "Observaci√≥n (opcional)";
    input.placeholder = "";
  }
}

/* ---------- RESET ---------- */
function resetSelection() {
  selected = null;
  grid.classList.remove("hidden");
  document.getElementById("selectedArea").classList.add("hidden");
}

/* ---------- ENVIO ---------- */
function send() {
  const texto = document.getElementById("textInput").value.toUpperCase();
  const legajo = document.getElementById("legajoInput").value;
  let valido = true;

  if (["EP","TP","AP","TAP","CR"].includes(selected.code)) {
    valido = /^[A-Z][0-9]{2}[A-Z]$/.test(texto);
  }

  if (selected.code === "CC") {
    valido = texto === "" || /^[A-Z][0-9]{2}$/.test(texto);
  }

  if (!valido) {
    document.getElementById("error").innerText = "C√≥digo incorrecto";
    return;
  }

  fetch(GOOGLE_SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      legajo: legajo,
      opcion: selected.code,
      descripcion: selected.desc,
      texto: texto
    })
  });

  alert("Reporte enviado correctamente");

  document.getElementById("optionsScreen").classList.add("hidden");
  document.getElementById("legajoScreen").classList.remove("hidden");
  document.getElementById("legajoInput").value = "";
  resetSelection();
}
</script>

</body>
</html>
